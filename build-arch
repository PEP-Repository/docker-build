FROM gitlabregistry.pep.cs.ru.nl/pep/docker-build/arch:master

RUN pacman -Syyu --needed --noconfirm archlinux-keyring && \
    pacman -Syu --needed --noconfirm clang base-devel ninja ccache distcc git gcc make cmake sqlite libevent bzip2 zlib curl readline pam valgrind vim qt5-base qt5-declarative qt5-tools libunwind go && rm -rf /var/cache/* /tmp/* && \
    pacman-db-upgrade && \
    mkdir /sources && cd /sources && \
    curl -OL https://dl.bintray.com/boostorg/release/1.69.0/source/boost_1_69_0.tar.gz && \
    tar -xzf boost_1_69_0.tar.gz && \
    cd boost_1_69_0 && \
    ./bootstrap.sh --with-toolset=clang && \
    ./b2 toolset=clang install && \
    rm -rf /sources

RUN go get -u github.com/golang/protobuf/protoc-gen-go
